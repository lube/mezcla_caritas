<% var title = 'Lobby'; %>
<h2 class="text-xl font-semibold mb-4">Lobby - Ronda <%= game.round %> (Dificultad: <%= game.difficulty %>)</h2>
<p class="mb-2">Participantes inscritos: <%= game.participants.length %></p>
<div class="grid grid-cols-3 gap-4 mb-4">
  <% game.participants.forEach(p => { %>
    <div class="flex flex-col items-center text-center">
      <img src="/<%= p.photoPath.split('/').slice(-3).join('/') %>" alt="<%= p.name %>" class="w-16 h-16 object-cover rounded-full mb-1">
      <span class="text-sm"><%= p.name %></span>
    </div>
  <% }) %>
</div>
<a href="/join" class="text-blue-600 underline">Unirse</a>
<form action="/start" method="post" class="mt-6 space-y-4">
  <div>
    <label class="block mb-1">Prompt de combinaci√≥n:</label>
    <textarea name="prompt" rows="2" class="w-full border rounded p-2"><%= game.prompt %></textarea>
  </div>
  <button type="submit" class="px-4 py-2 bg-blue-600 text-white font-semibold rounded hover:bg-blue-700">Comenzar ronda</button>
</form>
<script>
    async function poll() {
      const res = await fetch('/status');
      const data = await res.json();
      if (data.state === 'generating') {
        window.location.href = '/wait';
      } else if (data.state === 'playing') {
        window.location.href = '/play';
      } else {
        setTimeout(poll, 2000);
      }
    }
    poll();
</script>
